#!/usr/bin/env bash


tput sgr0

YELLOW=$(tput setaf 3)
GREEN=$(tput setaf 2)
RESET=$(tput sgr0)

function kproxy() {
  local ACTION="$1"
  case $ACTION in
    enable )
      kproxy_enable
      ;;
    disable )
      kproxy_disable
      ;;
    * )
      if [[ $KPROXY_ENABLED ]]; then
        kproxy_disable
      else
        kproxy_enable
      fi
      ;;
  esac
}

function kproxy_enable() {
  export HTTP_PROXY=${K_HTTP_PROXY}
  export HTTPS_PROXY=${K_HTTPS_PROXY}
  export http_proxy=${K_HTTP_PROXY}
  export https_proxy=${K_HTTPS_PROXY}
  export KPROXY_ENABLED="1"
  echo "\n == Proxy Enabled ==${GREEN}"
  echo " ➜ HTTP_PROXY: ${HTTP_PROXY}"
  echo " ➜ HTTPS_PROXY: ${HTTPS_PROXY}"
  echo " ➜ http_proxy: ${http_proxy}"
  echo " ➜ https_proxy: ${https_proxy}${RESET}"
}

function kproxy_disable() {
  export HTTP_PROXY=""
  export HTTPS_PROXY=""
  export http_proxy=""
  export https_proxy=""
  export KPROXY_ENABLED=""
  echo "\n == Proxy Disabled ==${YELLOW}"
  echo " ➜ HTTP_PROXY: ${HTTP_PROXY}"
  echo " ➜ HTTPS_PROXY: ${HTTPS_PROXY}"
  echo " ➜ http_proxy: ${http_proxy}"
  echo " ➜ https_proxy: ${https_proxy}${RESET}"
}

[[ "$1" != "" ]] && kproxy "$1"
