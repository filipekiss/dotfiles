#!/usr/bin/env bash
! has_dotfiles_function > /dev/null 2>&1 && [[ -e $HOME/.dotfiles/bin/dotfiles ]] && source $HOME/.dotfiles/bin/dotfiles "source"
! has_dotfiles_function > /dev/null 2>&1 && echo "Something went wrong. Try again" && exit 1

function saraiva-docker() {
  local action="$1"
  shift
  case $action in
    up )
      e_info "Starting docker from $SARAIVA_COMPOSER_FILE"
      $HAS_DOCKER_COMPOSE -f $SARAIVA_COMPOSER_FILE up -d
      ;;
    down )
      e_info "Stopping docker from $SARAIVA_COMPOSER_FILE"
      $HAS_DOCKER_COMPOSE -f $SARAIVA_COMPOSER_FILE down
      ;;
    grunt )
      e_info "Running grunt..."
      $HAS_DOCKER_COMPOSE -f $SARAIVA_COMPOSER_FILE exec grunt grunt "$@"
      ;;
    exec )
      e_info "Execing..."
      $HAS_DOCKER_COMPOSE -f $SARAIVA_COMPOSER_FILE exec "$@"
      ;;
    * )
      e_info "No action specified"
      e_info "USAGE: saraiva-docker <up|down|grunt>"
      e_line " grunt accepts the following options: prod, watch, uglify"
    ;;
  esac
}

[[ -z $SARAIVA_COMPOSER_FILE ]] && export SARAIVA_COMPOSER_FILE="${HOME}/work/saraiva-docker/docker-compose.yml"
HAS_DOCKER_COMPOSE=$(command -v docker-compose)
saraiva-docker "$@"
